{% extends 'public/base_cpanel.html' %}
<!--Cambiando el title-->
{% block title %}Crud con Python  | Lista de Empleados{% endblock %}
<!--Inicio del block-->
{% block body %}

<div class="card" style="border-radius: 0px !important">
  <div class="row justify-content-center mb-2">
    <div class="col-md-12 mb-4">
      <h3 class="text-center mt-5 mb-3">LISTA DE EMPLEADOS</h3>
      <hr />
    </div>

    <!-- Buscador -->
    <div class="row justify-content-end">
      <div class="col-md-6 mt-4 py-2">
        <input
          type="search"
          id="search"
          class="form-control border-0 shadow-none"
          placeholder="Buscar empleado..."
          onkeyup="buscadorTable('tbl_empleados')" />
      </div>
    </div>

    <!-- Bot贸n Descargar informe (mismo estilo que inventario) -->
    <div class="row justify-content-end">
      <div class="col-md-3 mt-2 mb-2 text-end">
        <a
          href="{{ url_for('descargar_informe_empleados') }}"
          class="btn btn-success btn-sm">
          <i class="bi bi-file-earmark-excel"></i>
          Descargar informe
        </a>
      </div>
    </div>

    <div class="row justify-content-center mb-2">
      <div class="table-responsive text-nowrap table-hover">
        <table
          id="tbl_empleados"
          class="table table-striped table-bordered"
          cellspacing="0"
          width="100%">
          <thead>
            <tr>
              <th>#</th>
              <th>Nombre</th>
              <th>Apellido</th>
              <th>Sexo</th>
              <th>Salario</th>
              <th>Acci贸n</th>
            </tr>
          </thead>
          <tbody>
            {% for empleado in empleados %}
            <tr id="empleado_{{ empleado.id_empleado }}">
              {# Numeraci贸n global seg煤n la p谩gina actual #}
              <td>{{ loop.index + (page - 1) * per_page }}</td>

              <td>{{ empleado.nombre_empleado }}</td>
              <td>{{ empleado.apellido_empleado }}</td>
              <td>{{ empleado.sexo_empleado }}</td>
              <td>
                $ {{ '{:,.0f}'.format(empleado.salario_empleado).replace(',', '.') }}
              </td>

              <td width="10px">
                <a
                  href="/detalles-empleado/{{ empleado.id_empleado }}"
                  class="btn btn-info btn-sm"
                  data-bs-toggle="tooltip"
                  title="<span>Ver detalles</span>">
                  <i class="bi bi-eye"></i>
                  Ver detalles
                </a>

                <a
                  href="{{ url_for('viewEditarEmpleado', id=empleado.id_empleado) }}"
                  class="btn btn-success btn-sm">
                  <i class="bi bi-arrow-clockwise"></i>
                  Actualizar
                </a>

                <a
                  href="#"
                  onclick="eliminarEmpleado('{{ empleado.id_empleado }}','{{ empleado.foto_empleado }}');"
                  class="btn btn-danger btn-sm"
                  data-bs-toggle="tooltip"
                  title="<span>Eliminar empleado {{ empleado.nombre_empleado }}</span>">
                  <i class="bi bi-trash3"></i>
                  Eliminar
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    {# ============================
       PAGINACIN
       ============================ #}
    <div class="row mt-3 mb-3">
      <div class="col-12">
        <nav aria-label="Paginaci贸n empleados">
          <ul class="pagination justify-content-end mb-0">

            {# Bot贸n ANTERIOR #}
            <li class="page-item {% if page <= 1 %}disabled{% endif %}">
              <a class="page-link"
                 href="{{ url_for('lista_empleados', page=page-1) }}"
                 tabindex="-1">Anterior</a>
            </li>

            {# N煤meros de p谩gina #}
            {% for p in range(1, total_pages + 1) %}
            <li class="page-item {% if p == page %}active{% endif %}">
              <a class="page-link"
                 href="{{ url_for('lista_empleados', page=p) }}">{{ p }}</a>
            </li>
            {% endfor %}

            {# Bot贸n SIGUIENTE #}
            <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
              <a class="page-link"
                 href="{{ url_for('lista_empleados', page=page+1) }}">Siguiente</a>
            </li>

          </ul>
        </nav>
      </div>
    </div>

  </div>
</div>

{% endblock %}
